#!/bin/bash

    # $1 - emu / sim / hw
    # $2 - filename to compile
    # $3 - hashed, unique file name

    
if [ "$1" == "emu" ]; then
	mkdir -p $(dirname $HOME/tmp/icpx-dad1e2/$3-header-dc392c.h)
 "/glob/development-tools/versions/oneapi/2023.1.1/oneapi/compiler/2023.1.0/linux/bin-llvm/clang++" -cc1 -triple spir64_fpga-unknown-unknown -aux-triple x86_64-unknown-linux-gnu -fsycl-is-device -fdeclare-spirv-builtins -fno-sycl-early-optimizations -fenable-sycl-dae -fsycl-instrument-device-code -Wno-sycl-strict -fsycl-int-header=$HOME/tmp/icpx-dad1e2/$3-header-dc392c.h -fsycl-int-footer=$HOME/tmp/icpx-dad1e2/$3-footer-baf84d.h -sycl-std=2020 -ffine-grained-bitfield-accesses -fsycl-unique-prefix=1b19a632f59d6b14 -fsycl-disable-range-rounding -fintelfpga -Wspir-compat -emit-llvm-bc -emit-llvm-uselists -disable-free -clear-ast-before-backend -disable-llvm-verifier -main-file-name "$2" -fsycl-use-main-file-name -full-main-file-name "$2" -mrelocation-model static -fveclib=SVML -mframe-pointer=all -fmath-errno -ffp-contract=on -fno-rounding-math -fno-verbose-asm -mconstructor-aliases -aux-target-cpu x86-64 -mllvm -treat-scalable-fixed-error-as-warning -debug-info-kind=limited -dwarf-version=4 -debugger-tuning=gdb   -resource-dir /glob/development-tools/versions/oneapi/2023.1.1/oneapi/compiler/2023.1.0/linux/lib/clang/16 -dependency-file $HOME/tmp/icpx-dad1e2/$3-4867a5.d -MT $3.o -internal-isystem /glob/development-tools/versions/oneapi/2023.1.1/oneapi/compiler/2023.1.0/linux/lib/oclfpga/include -internal-isystem /glob/development-tools/versions/oneapi/2023.1.1/oneapi/compiler/2023.1.0/linux/bin-llvm/../include/sycl -internal-isystem /glob/development-tools/versions/oneapi/2023.1.1/oneapi/compiler/2023.1.0/linux/bin-llvm/../include -I $HOME/git/elastic-sycl-hls/include_sycl -I $HOME/git/elastic-sycl-hls/lsq -D FPGA_EMU -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/tbb/2021.9.0/env/../include -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/mpi/2021.9.0//include -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/mkl/2023.1.0/include -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/ipp/2021.8.0/include -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/ippcp/2021.7.0/include -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/ipp/2021.8.0/include -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/dpl/2022.1.0/linux/include -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/dpcpp-ct/2023.1.0/include -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/dnnl/2023.1.0/cpu_dpcpp_gpu_dpcpp/include -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/dev-utilities/2021.9.0/include -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/dal/2023.1.0/include -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/ccl/2021.9.0/include/cpu_gpu_dpcpp -cxx-isystem /glob/development-tools/versions/oneapi/2023.1.1/oneapi/clck/2021.7.3/include -internal-isystem /glob/development-tools/versions/oneapi/2023.1.1/oneapi/compiler/2023.1.0/linux/bin-llvm/../compiler/include -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/7/../../../../include/c++/7 -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/7/../../../../include/x86_64-linux-gnu/c++/7 -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/7/../../../../include/c++/7/backward -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/7/../../../../include/c++/7 -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/7/../../../../include/x86_64-linux-gnu/c++/7 -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/7/../../../../include/c++/7/backward -internal-isystem /glob/development-tools/versions/oneapi/2023.1.1/oneapi/compiler/2023.1.0/linux/lib/clang/16/include -internal-isystem /usr/local/include -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/7/../../../../x86_64-linux-gnu/include -internal-externc-isystem /usr/include/x86_64-linux-gnu -internal-externc-isystem /include -internal-externc-isystem /usr/include -internal-isystem /glob/development-tools/versions/oneapi/2023.1.1/oneapi/compiler/2023.1.0/linux/lib/clang/16/include -internal-isystem /usr/local/include -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/7/../../../../x86_64-linux-gnu/include -internal-externc-isystem /usr/include/x86_64-linux-gnu -internal-externc-isystem /include -internal-externc-isystem /usr/include -O2 -std=c++17 -fdeprecated-macro -fdebug-compilation-dir=$HOME/git/elastic-sycl-hls/scripts/compilation/$3 -ferror-limit 19 -fheinous-gnu-extensions -fgpu-rdc -fgnuc-version=4.2.1 -no-opaque-pointers -fcxx-exceptions -fexceptions -vectorize-loops -vectorize-slp -dwarf-debug-flags " --driver-mode=g++ --intel -I $HOME/git/elastic-sycl-hls/include_sycl -I $HOME/git/elastic-sycl-hls/lsq -std=c++17 -O2 -qactypes -ffp-model=precise   -fintelfpga -D FPGA_EMU "$2" -o bin/$3.fpga_emu -g -fveclib=SVML -fheinous-gnu-extensions" -D__GCC_HAVE_DWARF2_CFI_ASM=1 -fintel-compatibility -fintel-compatibility-disable=FakeLoad -fintel-libirc-allowed -mllvm -disable-hir-generate-mkl-call -mllvm -intel-abi-compatible=true -o "$2.bc" -x c++ "$2"
exit
fi

if [ "$1" == "hw" ]; then
	mkdir -p $(dirname $HOME/tmp/icpx-dbfceb/$3-header-6c8fb7.h)
 "/glob/development-tools/versions/oneapi/2023.1.1/oneapi/compiler/2023.1.0/linux/bin-llvm/clang++" -cc1 -triple spir64_fpga-unknown-unknown -aux-triple x86_64-unknown-linux-gnu -fsycl-is-device -fdeclare-spirv-builtins -fno-sycl-early-optimizations -fenable-sycl-dae -fsycl-instrument-device-code -Wno-sycl-strict -fsycl-int-header=$HOME/tmp/icpx-dbfceb/$3-header-6c8fb7.h -fsycl-int-footer=$HOME/tmp/icpx-dbfceb/$3-footer-299f48.h -sycl-std=2020 -ffine-grained-bitfield-accesses -fsycl-unique-prefix=e2be4908cdcd1c7c -fsycl-disable-range-rounding -fintelfpga -Wspir-compat -emit-llvm-bc -emit-llvm-uselists -disable-free -clear-ast-before-backend -disable-llvm-verifier -main-file-name "$2" -fsycl-use-main-file-name -full-main-file-name "$2" -mrelocation-model static -fveclib=SVML -mframe-pointer=all -fmath-errno -ffp-contract=on -fno-rounding-math -fno-verbose-asm -mconstructor-aliases -aux-target-cpu x86-64 -mllvm -treat-scalable-fixed-error-as-warning -debug-info-kind=limited -dwarf-version=4 -debugger-tuning=gdb   -resource-dir /glob/development-tools/versions/oneapi/2023.1.1/oneapi/compiler/2023.1.0/linux/lib/clang/16 -dependency-file $HOME/tmp/icpx-dbfceb/$3-898815.d -MT $3.o -internal-isystem /glob/development-tools/versions/oneapi/2023.1.1/oneapi/compiler/2023.1.0/linux/lib/oclfpga/include -internal-isystem /glob/development-tools/versions/oneapi/2023.1.1/oneapi/compiler/2023.1.0/linux/bin-llvm/../include/sycl -internal-isystem /glob/development-tools/versions/oneapi/2023.1.1/oneapi/compiler/2023.1.0/linux/bin-llvm/../include -I $HOME/git/elastic-sycl-hls/include_sycl -I $HOME/git/elastic-sycl-hls/lsq -D FPGA_HW -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/tbb/2021.9.0/env/../include -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/mpi/2021.9.0//include -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/mkl/2023.1.0/include -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/ipp/2021.8.0/include -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/ippcp/2021.7.0/include -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/ipp/2021.8.0/include -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/dpl/2022.1.0/linux/include -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/dpcpp-ct/2023.1.0/include -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/dnnl/2023.1.0/cpu_dpcpp_gpu_dpcpp/include -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/dev-utilities/2021.9.0/include -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/dal/2023.1.0/include -I/glob/development-tools/versions/oneapi/2023.1.1/oneapi/ccl/2021.9.0/include/cpu_gpu_dpcpp -cxx-isystem /glob/development-tools/versions/oneapi/2023.1.1/oneapi/clck/2021.7.3/include -internal-isystem /glob/development-tools/versions/oneapi/2023.1.1/oneapi/compiler/2023.1.0/linux/bin-llvm/../compiler/include -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/7/../../../../include/c++/7 -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/7/../../../../include/x86_64-linux-gnu/c++/7 -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/7/../../../../include/c++/7/backward -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/7/../../../../include/c++/7 -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/7/../../../../include/x86_64-linux-gnu/c++/7 -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/7/../../../../include/c++/7/backward -internal-isystem /glob/development-tools/versions/oneapi/2023.1.1/oneapi/compiler/2023.1.0/linux/lib/clang/16/include -internal-isystem /usr/local/include -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/7/../../../../x86_64-linux-gnu/include -internal-externc-isystem /usr/include/x86_64-linux-gnu -internal-externc-isystem /include -internal-externc-isystem /usr/include -internal-isystem /glob/development-tools/versions/oneapi/2023.1.1/oneapi/compiler/2023.1.0/linux/lib/clang/16/include -internal-isystem /usr/local/include -internal-isystem /usr/lib/gcc/x86_64-linux-gnu/7/../../../../x86_64-linux-gnu/include -internal-externc-isystem /usr/include/x86_64-linux-gnu -internal-externc-isystem /include -internal-externc-isystem /usr/include -O2 -std=c++17 -fdeprecated-macro -fdebug-compilation-dir=$HOME/git/elastic-sycl-hls/scripts/compilation/$3 -ferror-limit 19 -fheinous-gnu-extensions -fgpu-rdc -fgnuc-version=4.2.1 -no-opaque-pointers -fcxx-exceptions -fexceptions -vectorize-loops -vectorize-slp -dwarf-debug-flags " --driver-mode=g++ --intel -I $HOME/git/elastic-sycl-hls/include_sycl -I $HOME/git/elastic-sycl-hls/lsq -std=c++17 -O2 -qactypes -ffp-model=precise   -fintelfpga -D FPGA_HW -Xshardware -Xsboard=intel_a10gx_pac:pac_a10 "$2" -o bin/$3.fpga_hw -g -fveclib=SVML -fheinous-gnu-extensions" -D__GCC_HAVE_DWARF2_CFI_ASM=1 -fintel-compatibility -fintel-compatibility-disable=FakeLoad -fintel-libirc-allowed -mllvm -disable-hir-generate-mkl-call -mllvm -intel-abi-compatible=true -o "$2.bc" -x c++ "$2"
exit
fi

printf 'Warning: No target matched.'